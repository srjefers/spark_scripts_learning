from pyspark.sql import SparkSession
from pyspark.sql.functions import col, monotonically_increasing_id, split
import pandas

spark = SparkSession.builder.appName("pivot_script_2").getOrCreate()

filePath = "/home/kernelpanic/Documents/SPARK/spark_sql/spark_pivot/BaseDatos.xlsx"

pdf = pandas.read_excel(filePath, sheet_name='5')

columns = pdf.columns.tolist()

Unit = pdf.loc[0, :].values.tolist()
Series_Type = pdf.loc[1, :].values.tolist()
Data_Type = pdf.loc[2, :].values.tolist()
Frequency = pdf.loc[3, :].values.tolist()
Collection_Month = pdf.loc[4, :].values.tolist()
Series_Start = pdf.loc[5, :].values.tolist()
Series_End = pdf.loc[6, :].values.tolist()
No_Obs = pdf.loc[7, :].values.tolist()
Series_ID = pdf.loc[8, :].values.tolist()

columns.remove('Unnamed: 0')
Unit.remove('Unit')
Series_Type.remove('Series Type')
Data_Type.remove('Data Type')
Frequency.remove('Frequency')
Collection_Month.remove('Collection Month')
Series_Start.remove('Series Start')
Series_End.remove('Series End')
No_Obs.remove('No. Obs')
Series_ID.remove('Series ID')


header = list(zip(columns, Unit, Series_Type, Data_Type, Frequency, Collection_Month, Series_Start, Series_End, No_Obs, Series_ID))
header_list = [list(pair) for pair in header]


for column in header_list:
    #str_column = str(column[0]).replace('.','_')
    pdf.rename(columns={column[0]: f'{str(column[0])},{str(column[1])},{str(column[2])},{str(column[3])},{str(column[4])},{str(column[5])},{str(column[6])},{str(column[7])},{str(column[8])},{str(column[9])}' }, inplace=True)

df = spark.createDataFrame(pdf)

depreacted_rows = [
    'Unit',
    'Series Type',
    'Data Type',
    'Frequency',
    'Collection Month',
    'Series Start',
    'Series End',
    'No. Obs',
    'Series ID'
]
df = df.filter(~df['Unnamed: 0'].isin(depreacted_rows))



df2 = df.unpivot('Unnamed: 0',['Australia ;  Number of additional hours preferred or hours not worked by underemployed ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081565C', 
                               'Australia ;  Number of additional hours preferred or hours not worked by underemployed ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081511W', 
                               'Australia ;  Number of additional hours preferred or hours not worked by underemployed ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081619X', 
                               'Australia ;  Volume measure of underemployment rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081568K', 
                               'Australia ;  Volume measure of underemployment rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081514C', 
                               'Australia ;  Volume measure of underemployment rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081622L', 
                               'Australia ;  Number of hours sought by unemployed ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081564A', 
                               'Australia ;  Number of hours sought by unemployed ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081510V', 
                               'Australia ;  Number of hours sought by unemployed ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081618W', 
                               'Australia ;  Volume measure of unemployment rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081567J', 
                               'Australia ;  Volume measure of unemployment rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081513A', 
                               'Australia ;  Volume measure of unemployment rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081621K', 
                               'Australia ;  Number of potential hours in the labour force ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081566F', 
                               'Australia ;  Number of potential hours in the labour force ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081512X', 
                               'Australia ;  Number of potential hours in the labour force ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081620J', 
                               'Australia ;  Volume measure of underutilisation rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081569L', 
                               'Australia ;  Volume measure of underutilisation rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081515F', 
                               'Australia ;  Volume measure of underutilisation rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081623R', 
                               '> New South Wales ;  Number of additional hours preferred or hours not worked by underemployed ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081571X', 
                               '> New South Wales ;  Number of additional hours preferred or hours not worked by underemployed ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081517K', 
                               '> New South Wales ;  Number of additional hours preferred or hours not worked by underemployed ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081625V', 
                               '> New South Wales ;  Volume measure of underemployment rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081574F', 
                               '> New South Wales ;  Volume measure of underemployment rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081520X', 
                               '> New South Wales ;  Volume measure of underemployment rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081628A', 
                               '> New South Wales ;  Number of hours sought by unemployed ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081570W', 
                               '> New South Wales ;  Number of hours sought by unemployed ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081516J', 
                               '> New South Wales ;  Number of hours sought by unemployed ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081624T', 
                               '> New South Wales ;  Volume measure of unemployment rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081573C', 
                               '> New South Wales ;  Volume measure of unemployment rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081519R', '> New South Wales ;  Volume measure of unemployment rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081627X', '> New South Wales ;  Number of potential hours in the labour force ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081572A', '> New South Wales ;  Number of potential hours in the labour force ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081518L', '> New South Wales ;  Number of potential hours in the labour force ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081626W', '> New South Wales ;  Volume measure of underutilisation rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081575J', '> New South Wales ;  Volume measure of underutilisation rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081521A', '> New South Wales ;  Volume measure of underutilisation rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081629C', '> Victoria ;  Number of additional hours preferred or hours not worked by underemployed ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081613K', '> Victoria ;  Number of additional hours preferred or hours not worked by underemployed ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081559J', '> Victoria ;  Number of additional hours preferred or hours not worked by underemployed ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081667T', '> Victoria ;  Volume measure of underemployment rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081616T', '> Victoria ;  Volume measure of underemployment rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081562W', '> Victoria ;  Volume measure of underemployment rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081670F', 
                               '> Victoria ;  Number of hours sought by unemployed ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081612J', '> Victoria ;  Number of hours sought by unemployed ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081558F', '> Victoria ;  Number of hours sought by unemployed ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081666R', '> Victoria ;  Volume measure of unemployment rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081615R', '> Victoria ;  Volume measure of unemployment rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081561V', '> Victoria ;  Volume measure of unemployment rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081669W', '> Victoria ;  Number of potential hours in the labour force ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081614L', '> Victoria ;  Number of potential hours in the labour force ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081560T', '> Victoria ;  Number of potential hours in the labour force ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081668V', '> Victoria ;  Volume measure of underutilisation rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081617V', '> Victoria ;  Volume measure of underutilisation rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081563X', '> Victoria ;  Volume measure of underutilisation rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081671J', '> Queensland ;  Number of additional hours preferred or hours not worked by underemployed ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081577L', '> Queensland ;  Number of additional hours preferred or hours not worked by underemployed ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081523F', '> Queensland ;  Number of additional hours preferred or hours not worked by underemployed ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081631R', '> Queensland ;  Volume measure of underemployment rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081580A', '> Queensland ;  Volume measure of underemployment rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081526L', '> Queensland ;  Volume measure of underemployment rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081634W', '> Queensland ;  Number of hours sought by unemployed ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081576K', '> Queensland ;  Number of hours sought by unemployed ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081522C', '> Queensland ;  Number of hours sought by unemployed ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081630L', 
                               '> Queensland ;  Volume measure of unemployment rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081579T', '> Queensland ;  Volume measure of unemployment rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081525K', '> Queensland ;  Volume measure of unemployment rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081633V', '> Queensland ;  Number of potential hours in the labour force ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081578R', '> Queensland ;  Number of potential hours in the labour force ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081524J', '> Queensland ;  Number of potential hours in the labour force ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081632T', '> Queensland ;  Volume measure of underutilisation rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081581C', '> Queensland ;  Volume measure of underutilisation rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081527R', '> Queensland ;  Volume measure of underutilisation rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081635X', '> South Australia ;  Number of additional hours preferred or hours not worked by underemployed ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081607R', '> South Australia ;  Number of additional hours preferred or hours not worked by underemployed ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081553V', '> South Australia ;  Number of additional hours preferred or hours not worked by underemployed ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081661C', '> South Australia ;  Volume measure of underemployment rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081610C', '> South Australia ;  Volume measure of underemployment rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081556A', '> South Australia ;  Volume measure of underemployment rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081664K', '> South Australia ;  Number of hours sought by unemployed ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081606L', '> South Australia ;  Number of hours sought by unemployed ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081552T', '> South Australia ;  Number of hours sought by unemployed ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081660A', '> South Australia ;  Volume measure of unemployment rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081609V', '> South Australia ;  Volume measure of unemployment rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081555X', '> South Australia ;  Volume measure of unemployment rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081663J', '> South Australia ;  Number of potential hours in the labour force ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081608T', '> South Australia ;  Number of potential hours in the labour force ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081554W', '> South Australia ;  Number of potential hours in the labour force ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081662F', '> South Australia ;  Volume measure of underutilisation rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081611F', '> South Australia ;  Volume measure of underutilisation rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081557C', '> South Australia ;  Volume measure of underutilisation rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081665L', '> Western Australia ;  Number of additional hours preferred or hours not worked by underemployed ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081595T', '> Western Australia ;  Number of additional hours preferred or hours not worked by underemployed ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081541K', '> Western Australia ;  Number of additional hours preferred or hours not worked by underemployed ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081649L', '> Western Australia ;  Volume measure of underemployment rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081598X', '> Western Australia ;  Volume measure of underemployment rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081544T', '> Western Australia ;  Volume measure of underemployment rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081652A', '> Western Australia ;  Number of hours sought by unemployed ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081594R', '> Western Australia ;  Number of hours sought by unemployed ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081540J', '> Western Australia ;  Number of hours sought by unemployed ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081648K', '> Western Australia ;  Volume measure of unemployment rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081597W', '> Western Australia ;  Volume measure of unemployment rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081543R', '> Western Australia ;  Volume measure of unemployment rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081651X', '> Western Australia ;  Number of potential hours in the labour force ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081596V', '> Western Australia ;  Number of potential hours in the labour force ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081542L', '> Western Australia ;  Number of potential hours in the labour force ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081650W', '> Western Australia ;  Volume measure of underutilisation rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081599A', '> Western Australia ;  Volume measure of underutilisation rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081545V', '> Western Australia ;  Volume measure of underutilisation rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081653C', '> Tasmania ;  Number of additional hours preferred or hours not worked by underemployed ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081583J', '> Tasmania ;  Number of additional hours preferred or hours not worked by underemployed ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081529V', '> Tasmania ;  Number of additional hours preferred or hours not worked by underemployed ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081637C', '> Tasmania ;  Volume measure of underemployment rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081586R', '> Tasmania ;  Volume measure of underemployment rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081532J', '> Tasmania ;  Volume measure of underemployment rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081640T', '> Tasmania ;  Number of hours sought by unemployed ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081582F', '> Tasmania ;  Number of hours sought by unemployed ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081528T', '> Tasmania ;  Number of hours sought by unemployed ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081636A', '> Tasmania ;  Volume measure of unemployment rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081585L', '> Tasmania ;  Volume measure of unemployment rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081531F', '> Tasmania ;  Volume measure of unemployment rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081639J', '> Tasmania ;  Number of potential hours in the labour force ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081584K', '> Tasmania ;  Number of potential hours in the labour force ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081530C', '> Tasmania ;  Number of potential hours in the labour force ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081638F', '> Tasmania ;  Volume measure of underutilisation rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081587T', '> Tasmania ;  Volume measure of underutilisation rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081533K', '> Tasmania ;  Volume measure of underutilisation rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081641V', '> Northern Territory ;  Number of additional hours preferred or hours not worked by underemployed ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081601A', '> Northern Territory ;  Number of additional hours preferred or hours not worked by underemployed ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081547X', '> Northern Territory ;  Number of additional hours preferred or hours not worked by underemployed ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081655J', '> Northern Territory ;  Volume measure of underemployment rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081604J', '> Northern Territory ;  Volume measure of underemployment rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081550L', '> Northern Territory ;  Volume measure of underemployment rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081658R', 
                               '> Northern Territory ;  Number of hours sought by unemployed ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081600X', '> Northern Territory ;  Number of hours sought by unemployed ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081546W', '> Northern Territory ;  Number of hours sought by unemployed ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081654F', '> Northern Territory ;  Volume measure of unemployment rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081603F', '> Northern Territory ;  Volume measure of unemployment rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081549C', '> Northern Territory ;  Volume measure of unemployment rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081657L', '> Northern Territory ;  Number of potential hours in the labour force ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081602C', '> Northern Territory ;  Number of potential hours in the labour force ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081548A', '> Northern Territory ;  Number of potential hours in the labour force ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081656K', '> Northern Territory ;  Volume measure of underutilisation rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081605K', '> Northern Territory ;  Volume measure of underutilisation rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081551R', '> Northern Territory ;  Volume measure of underutilisation rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081659T', '> Australian Capital Territory ;  Number of additional hours preferred or hours not worked by underemployed ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081589W', '> Australian Capital Territory ;  Number of additional hours preferred or hours not worked by underemployed ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081535R', '> Australian Capital Territory ;  Number of additional hours preferred or hours not worked by underemployed ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081643X', '> Australian Capital Territory ;  Volume measure of underemployment rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081592K', '> Australian Capital Territory ;  Volume measure of underemployment rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081538W', '> Australian Capital Territory ;  Volume measure of underemployment rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081646F', '> Australian Capital Territory ;  Number of hours sought by unemployed ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081588V', '> Australian Capital Territory ;  Number of hours sought by unemployed ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081534L', '> Australian Capital Territory ;  Number of hours sought by unemployed ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081642W', '> Australian Capital Territory ;  Volume measure of unemployment rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081591J', '> Australian Capital Territory ;  Volume measure of unemployment rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081537V', '> Australian Capital Territory ;  Volume measure of unemployment rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081645C', '> Australian Capital Territory ;  Number of potential hours in the labour force ;  Persons ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081590F', '> Australian Capital Territory ;  Number of potential hours in the labour force ;  > Males ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081536T', '> Australian Capital Territory ;  Number of potential hours in the labour force ;  > Females ;,000 Hours,Original,STOCK,Quarter,2,41852,45413,40,A84081644A', '> Australian Capital Territory ;  Volume measure of underutilisation rate ;  Persons ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081593L', '> Australian Capital Territory ;  Volume measure of underutilisation rate ;  > Males ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081539X', 
                               '> Australian Capital Territory ;  Volume measure of underutilisation rate ;  > Females ;,Percent,Original,PERCENT,Quarter,2,41852,45413,40,A84081647J'],
                               'compose_value','value')


df2 = df2.withColumn('description',split(df2['compose_value'],',').getItem(0))
df2 = df2.withColumn('Unit',split(df2['compose_value'],',').getItem(1))
df2 = df2.withColumn('Series_Type',split(df2['compose_value'],',').getItem(2))
df2 = df2.withColumn('Data_Type',split(df2['compose_value'],',').getItem(3))
df2 = df2.withColumn('Frequency',split(df2['compose_value'],',').getItem(4))
df2 = df2.withColumn('Collection_Month',split(df2['compose_value'],',').getItem(5))
df2 = df2.withColumn('Series_Start',split(df2['compose_value'],',').getItem(6))
df2 = df2.withColumn('Series_End',split(df2['compose_value'],',').getItem(7))
df2 = df2.withColumn('No_Obs',split(df2['compose_value'],',').getItem(8))
df2 = df2.withColumn('Series_ID',split(df2['compose_value'],',').getItem(9))

df2 = df2.drop('compose_value')

#df2.show()

df2.toPandas().to_csv('model_5.csv')